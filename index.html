<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>TR Queue</title>
  <meta name="description" content="TR Queue">
  <meta name="author" content="Tristan Melton">
</head>

<body>
<script src="/socket.io/socket.io.js"></script>
<script>
$(function () 
{
	var minutesLabel = document.getElementById("minutes");
	var secondsLabel = document.getElementById("seconds");
	var name = "";
	var role = "";
	var totalSeconds = 0;
	var socket = io();
	
	$('queueform').submit(function()
	{
        name = document.getElementById("sname").value;
        role = document.getElementById("rolelist").value;
		socket.emit('enterqueue', name + " " + role);
		setTiming();
		
		return false;
	});
	socket.on('error', function(msg)
	{
		window.alert(msg);
    });

});
</script>

	<form id="queueform">
	Summoner Name: <input type="text" name="sname" id="sname" value="Summoner">
    </form>
  	<p>Role:<select name="rolelist" id="rolelist" form="queueform" >
			<option value="Tops">Top</option>
			<option value="Jungles">Jungle</option>
			<option value="Mids">Mid</option>
			<option value="Bots">Bot</option>
			<option value="Supports">Support</option>
		</select>
	</p>
	<p><button type="submit" form="queueform" name="queue" onclick="manipQueue()">Queue Up!</button>
		<button type="submit" name="exitqueue" onclick="queueinfo('exitqueue.php')">Exit Queue</button>
    </p>
  <p>Click queue up when you are ready!</p>
  <font size="8" id="qtxt" color="red"></font>
  <font size="8" color="red" id="minutes">00</font><font size="8" color="red">:</font><font size="8" color="red" id="seconds">00</font>
<script>
function setTiming()
{
    setInterval(setTime, 1000);
}
function queueInfo(action) 
{
    document.getElementById("qtxt").innerHTML = "In Queue!  Waiting for:  ";
    setInterval(setTime, 1000);
    
    var form = document.getElementById('queueform');
    form.action = action;
    
    form.submit();
}
function setTime()
{
    ++totalSeconds;
    secondsLabel.innerHTML = pad(totalSeconds % 60);
    minutesLabel.innerHTML = pad(parseInt(totalSeconds / 60));
}
function pad(val) 
{
    var valString = val + "";
    if (valString.length < 2) {
        return "0" + valString;
    }
    else 
    {
        return valString;
    }
}
</script>
</body>
</html>